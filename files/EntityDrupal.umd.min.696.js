"use strict";(("undefined"!==typeof self?self:this)["webpackChunkEntityDrupal"]=("undefined"!==typeof self?self:this)["webpackChunkEntityDrupal"]||[]).push([[696],{96696:function(t,e,i){i.r(e),i.d(e,{default:function(){return p}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ValidationProvider",{attrs:{name:t.fullname,rules:t.getRules()},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"d-none for-test"},[t._v("MultiSelectEntities : "+t._s(t.field.type))]),i("b-form-group",{attrs:{label:t.field.label,description:t.field.description}},[i("div",{staticClass:"autocomplete"},[i("multiselect",{attrs:{options:t.options,"custom-label":t.nameWithLang,placeholder:"",label:"text","track-by":"text","show-no-results":!0,"show-labels":!1,loading:t.isLoading,multiple:t.cardinality,"allow-empty":!0},on:{"search-change":t.asyncFind},model:{value:t.value_computed,callback:function(e){t.value_computed=e},expression:"value_computed"}},[i("template",{slot:"noResult"},[i("span",{staticClass:"option__title"},[t._v(" Aucun contenu ne correspond à votre recherche ")])]),i("template",{slot:"placeholder"},[i("span",{staticClass:"option__title"},[t._v(" Aucun contenu ... ")])]),i("template",{slot:"noOptions"},[i("span",{staticClass:"option__title"},[t._v(" Saisir un ou plusieurs caractères ... ")])])],2),i("div",{staticClass:"text-danger"},t._l(e.errors,(function(e,n){return i("small",{key:n,staticClass:"d-block"},[t._v(" "+t._s(e)+" ")])})),0)],1)])]}}])})},a=[],s=(i(60343),i(67399),i(11566),i(91605),i(85549)),l=i(89297),r=i.n(l),u=i(70915),o=i(86370),d={name:"MultiSelectEntities",components:{ValidationProvider:s.d_,Multiselect:r()},props:{field:{type:Object,required:!0},model:{type:[Object,Array],required:!0},namespaceStore:{type:String,required:!0},parentName:{type:String,required:!0},overrideConfig:{type:Boolean,default:!1}},data:function(){return{isLoading:!1,options:[],value_select:null}},computed:{fullname:function(){return this.parentName+this.field.name},cardinality:function(){return-1===this.field.cardinality},value_computed:{get:function(){return this.value_select},set:function(t){this.updateValue(t)}}},mounted:function(){this.loadDefaults()},methods:{getTermById:function(t){var e=this,i=this.getFistVocab();if(i&&o.Z.config){var n=this.field.definition_settings.bundle_entity_type_id?this.field.definition_settings.bundle_entity_type_id:i,a=new u.Z(i,n,o.Z.config);this.overrideConfig&&(a.remplaceConfig(),console.log("getTermById :::",this.overrideConfig)),this.isLoading=!0,a.getValueById(t).then((function(){var t=a.getOptions();t[0]&&(e.options.push(t[0]),e.cardinality?e.value_select.push(t[0]):t[0]&&(e.value_select=t[0])),e.isLoading=!1})).catch((function(){e.isLoading=!1}))}},loadDefaults:function(){var t=this;this.value_select=[],this.model[this.field.name].forEach((function(e){t.getTermById(e.target_id)}))},getFistVocab:function(){if(this.field.definition_settings.handler_settings.target_bundles){var t=Object.keys(this.field.definition_settings.handler_settings.target_bundles);return this.field.definition_settings.handler_settings.target_bundles[t[0]]}return this.field.definition_settings.target_type?this.field.definition_settings.target_type:null},asyncFind:function(t){var e=this;if(t.length>=2){var i=this.getFistVocab();if(i&&o.Z.config){var n=this.field.definition_settings.bundle_entity_type_id?this.field.definition_settings.bundle_entity_type_id:i,a=new u.Z(i,n,o.Z.config);this.overrideConfig&&a.remplaceConfig(),this.isLoading=!0,a.getSearch(t).then((function(){e.options=a.getOptions(),e.isLoading=!1})).catch((function(){e.isLoading=!1}))}}},nameWithLang:function(t){var e=t.text;return"".concat(e)},setValue:function(t){this.namespaceStore?this.$store.dispatch(this.namespaceStore+"/setValue",{value:t,fieldName:this.fullname}):this.$store.dispatch("setValue",{value:t,fieldName:this.fullname})},getRules:function(){return o.Z.getRules(this.field)},updateValue:function(t){if(this.value_select=t,this.cardinality){var e=[];t&&t.length&&t.forEach((function(t){e.push({target_id:t.value})})),this.setValue(e)}else{var i=[];t&&t.value&&i.push({target_id:t.value}),this.setValue(i)}}}},c=d,f=i(1001),h=(0,f.Z)(c,n,a,!1,null,null,null),p=h.exports},70915:function(t,e,i){var n=i(93995),a=i(86017),s=(i(41539),i(88674),i(26699),i(32023),i(68309),i(1730)),l=i(5334),r=i(57724),u=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,n.Z)(this,t),this.entity_type_id=e,i||(i=e),this.url=l.Z.baseURl+"/"+this.entity_type_id+"/"+i,this.items=[],this.newConfig=a,a&&a.TestDomain&&(s.Z.TestDomain=a.TestDomain),this.filterQuery=""}return(0,a.Z)(t,[{key:"get",value:function(){var t=this;return new Promise((function(e){t.filterQuery&&(t.filterQuery=t.url.includes("?")?"&"+t.filterQuery:"?"+t.filterQuery),s.Z.dGet(t.url+t.filterQuery,l.Z.headers).then((function(i){t.items=i.data,e(i.data)}))}))}},{key:"getSearch",value:function(t){var e=this,i=new r.Z;return i.addFilter("name","CONTAINS",t),new Promise((function(t){s.Z.dGet(e.url+"?"+i.query,l.Z.headers).then((function(i){e.items=i.data,t(i.data)}))}))}},{key:"getValue",value:function(t){var e=this,i=new r.Z;return i.addFilter("name","=",t),new Promise((function(t){s.Z.dGet(e.url+"?"+i.query,l.Z.headers).then((function(i){e.items=i.data,t(i.data)}))}))}},{key:"getValueByTid",value:function(t){var e=this,i=new r.Z;return i.addFilter("tid","=",t),new Promise((function(t,n){s.Z.dGet(e.url+"?"+i.query,l.Z.headers).then((function(i){e.items=i.data,t(i.data)})).catch((function(t){n(t)}))}))}},{key:"getValueById",value:function(t){var e=this,i=new r.Z,n="drupal_internal__id";switch(this.entity_type_id){case"user":n="uid";break;case"node":n="drupal_internal__nid";break;case"taxonomy_term":n="tid";break}return i.addFilter(n,"=",t),new Promise((function(t){s.Z.dGet(e.url+"?"+i.query,l.Z.headers).then((function(i){e.items=i.data,t(i.data)}))}))}},{key:"filter",value:function(t,e,i){var n=new r.Z;n.addFilter(t,e,i),n.query&&(this.filterQuery+=n.query)}},{key:"addIncludesEntities",value:function(){}},{key:"getOptions",value:function(){var t=[];for(var e in this.items.data){var i=this.items.data[e];"user"==this.entity_type_id?t.push({text:i.attributes.name?i.attributes.name:i.attributes.display_name,value:i.attributes.drupal_internal__uid}):i.attributes.name?t.push({text:i.attributes.name,value:i.attributes.drupal_internal__id}):i.attributes.label&&t.push({text:i.attributes.label,value:i.attributes.drupal_internal__id})}return t}},{key:"remplaceConfig",value:function(){for(var t in this.newConfig)s.Z[t]=this.newConfig[t]}}]),t}();e["Z"]=u}}]);
//# sourceMappingURL=EntityDrupal.umd.min.696.js.map