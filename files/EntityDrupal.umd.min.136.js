(("undefined"!==typeof self?self:this)["webpackChunkEntityDrupal"]=("undefined"!==typeof self?self:this)["webpackChunkEntityDrupal"]||[]).push([[136],{48136:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return N}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n(t.render_template,{tag:"component"})],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"step-donneesite mx-auto text-center"},[n("progressBar"),n("ValidationObserver",{attrs:{tag:"form"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(t.stepFields,(function(t,e){return n(t.template,{key:e,tag:"component",attrs:{field:t.field,model:t.model,class_css:["fieldset-wrapper",t.field.type]}})})),n("div",[n("nextPreviewVue",{attrs:{validation_form:e}})],1)]}}])})],1)},o=[],a=n(79296),u=(n(68309),n(66992),n(41539),n(33948),n(54747),n(77203)),c=n.n(u),l=n(91555),d=n(19943),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex justify-content-between align-items-center step-donneesite--submit mx-auto",attrs:{check_validation:t.check_validation}},[t.current_step&&!t.creation_running?n("b-button",{attrs:{variant:"secondary"},on:{click:t.previewStep}},[n("b-icon",{attrs:{icon:"arrow-left"}}),t._v(" Precedent ")],1):t._e(),t.count_step<t.steppers.length?n("b-button",{attrs:{variant:"primary",disabled:t.disabled||t.disable_submit},on:{click:t.nextStep}},[t._v(" Suivant "),n("b-icon",{attrs:{icon:"arrow-right"}})],1):t._e(),t.count_step>=t.steppers.length&&!t.finish_status?n("b-button",{attrs:{variant:"primary",disabled:t.creation_running},on:{click:t.create_site}},[t._v(" je cree mon site "),t.creation_running?t._e():n("b-icon",{staticClass:"ml-2",attrs:{icon:"check2","font-scale":"2"}}),t.creation_running?n("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise","font-scale":"2",animation:"spin"}}):t._e()],1):t._e()],1)},f=[],h=(n(26699),n(32023),{name:"next-preview",props:{validation_form:{type:Object,required:!0}},data:function(){return{disabled:!1}},mounted:function(){this.ajustStep()},computed:(0,a.Z)((0,a.Z)({},(0,l.rn)({creation_running:function(t){return t.creation_running},steppers:function(t){return t.renderByStep.steppers},current_step:function(t){return t.renderByStep.current_step},finish_status:function(t){return t.finish_status},valid_steppers:function(t){return t.renderByStep.valid_steppers}})),{},{count_step:function(){return this.current_step+1},check_validation:function(){return!(!this.disabled||!this.validation_form.valid)&&(this.validationStep(),!0)},disable_submit:function(){var t=this.steppers[this.current_step];return!!(t&&t.templates&&t.templates.includes("page_register"))}}),methods:{nextStep:function(){this.validationStep()&&(this.$store.commit("renderByStep/nextStep"),this.$router.push({path:"/form-render/".concat(this.current_step)}))},previewStep:function(){var t=this,e=parseInt(this.$route.params.idstep),n=this.valid_steppers.length;if(this.valid_steppers.length>1){var r=this.valid_steppers[n-2];e==r?this.$store.dispatch("renderByStep/removeLastValidStep").then((function(){t.previewStep()})):this.$store.dispatch("renderByStep/removeLastValidStep").then((function(){t.$router.push({path:"/form-render/".concat(r)})}))}},validationStep:function(){if(this.validation_form.valid)return this.disabled=!1,!0;this.validation_form.validate(),this.disabled=!0},ajustStep:function(){var t=parseInt(this.$route.params.idstep);parseInt(this.current_step)!==t&&t<=this.steppers.length&&this.$store.commit("renderByStep/nextStep",t)},create_site:function(){this.$store.dispatch("create_site")}}}),m=h,v=n(1001),_=(0,v.Z)(m,p,f,!1,null,null,null),y=_.exports,g=n(85549),b=n(69832),S=n.n(b),$=n(22662),x=n(17432),k=n(85701),w=n(32864),E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-progress position-relative p-4"},[n("ul",{staticClass:"progressive-bar d-flex"},t._l(t.steppers,(function(e,r){return n("li",{key:r,class:t.current_step>=r?"active":"none"})})),0)])},O=[],C={name:"progress-bar",computed:(0,a.Z)({},(0,l.rn)("renderByStep",{current_step:function(t){return t.current_step},steppers:function(t){return t.steppers}}))},D=C,j=(0,v.Z)(D,E,O,!1,null,null,null),B=j.exports;c().use(S());var Z={name:"renderByStep",data:function(){return{fields:[]}},components:{nextPreviewVue:y,ValidationObserver:g._j,progressBar:B},mounted:function(){},computed:(0,a.Z)((0,a.Z)({},(0,l.rn)("renderByStep",{form:function(t){return t.form},current_step:function(t){return t.current_step},model:function(t){return t.model},steppers:function(t){return t.steppers},running:function(t){return t.running}})),(0,l.Se)("renderByStep",["stepFields"])),methods:{buildFields:function(){var t=this;console.log("buildFields"),this.fields=[];var e=this.steppers[this.current_step],n=!0;if(e.states&&e.states.length){var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e.states[t])return e.states[t]},i=r(0);console.log("sate :",i),"check_user_login"==i.custom?this.$store.state.user&&this.$store.state.user.uid&&this.$store.state.user.uid[0]&&(n=!1):i.step&&i.step.name&&this.model[i.step.name]&&this.model[i.step.name].length&&this.model[i.step.name][0].value==i.step.value&&(n=!1)}return n?(e.keys&&e.keys.length&&e.keys.forEach((function(e){t.form[e]&&(t.model[e]?t.fields.push({template:d.Z.getField(t.form[e]),field:t.form[e],model:t.model}):t.fields.push({template:d.Z.getField(t.form[e]),field:t.form[e]}))})),e.templates&&e.templates.length&&e.templates.forEach((function(e){"layout_entete"==e?t.fields.push({template:$.Z,field:{}}):"layout_footer"==e?t.fields.push({template:x.Z,field:{}}):"page_register"==e?t.fields.push({template:k.Z,field:{}}):"page_save"==e&&t.fields.push({template:w.Z,field:{}})})),this.$store.commit("renderByStep/ADD_VALID_STEP",this.current_step),this.fields):(this.$store.commit("renderByStep/nextStep"),void this.$router.push({path:"/form-render/".concat(this.current_step)}))}}},T=Z,R=(0,v.Z)(T,s,o,!1,null,null,null),I=R.exports,P=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},F=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"about"},[n("h1",[t._v("This is an about page")])])}],K={},V=(0,v.Z)(K,P,F,!1,null,null,null),L=V.exports,U={data:function(){return{render_template:null,type_render:"by-step"}},name:"formRender",mounted:function(){this.getRender()},methods:{getRender:function(){switch(this.type_render){case"by-step":this.render_template=I;break;default:this.render_template=L;break}}}},A=U,M=(0,v.Z)(A,r,i,!1,null,null,null),N=M.exports},69832:function(t,e,n){var r,i,s;t=n.nmd(t);var o=n(10338)["default"];n(82526),n(41817),n(41539),n(39341),n(73706),n(10408),n(21703),n(88674),n(26699),n(9653),n(92222),function(n,a){"object"==o(e)&&"object"==o(t)?t.exports=a():(i=[],r=a,s="function"===typeof r?r.apply(e,i):r,void 0===s||(t.exports=s))}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==o(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function i(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}var s;function o(t,e){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):"string"!=typeof t||t.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(s||(s=o.scriptLoader(t).then((function(t){return e&&e(t),t}))),s)}n.r(e),o.scriptLoader=function(t){return new Promise((function(e,n){!function(t,e,n){var s=document.head||document.getElementsByTagName("head")[0],o=document.createElement("script");"function"==typeof e&&(n=e,e={}),e=e||{},n=n||function(){},o.type=e.type||"text/javascript",o.charset=e.charset||"utf8",o.async=!("async"in e)||!!e.async,o.src=t,e.attrs&&function(t,e){for(var n in e)t.setAttribute(n,e[n])}(o,e.attrs),e.text&&(o.text=String(e.text)),("onload"in o?r:i)(o,n),o.onload||r(o,n),s.appendChild(o)}(t,(function(t){return s=void 0,t?n(t):window.CKEDITOR?void e(CKEDITOR):n(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."))}))}))};var a={name:"ckeditor",render:function(t){return t("div",{},[t(this.tagName)])},props:{value:{type:String,default:""},type:{type:String,default:"classic",validator:function(t){return["classic","inline"].includes(t)}},editorUrl:{type:String,default:"https://cdn.ckeditor.com/4.18.0/standard-all/ckeditor.js"},config:{type:Object,default:function(){}},tagName:{type:String,default:"textarea"},readOnly:{type:Boolean,default:null},throttle:{type:Number,default:80}},mounted:function(){var t=this;o(this.editorUrl,(function(e){t.$emit("namespaceloaded",e)})).then((function(){if(!t.$_destroyed){var e=t.prepareConfig(),n="inline"===t.type?"inline":"replace",r=t.$el.firstElementChild;CKEDITOR[n](r,e)}}))},beforeDestroy:function(){this.instance&&this.instance.destroy(),this.$_destroyed=!0},watch:{value:function(t){this.instance&&this.instance.getData()!==t&&this.instance.setData(t)},readOnly:function(t){this.instance&&this.instance.setReadOnly(t)}},methods:{prepareConfig:function(){var t=this,e=this.config||{};e.on=e.on||{},void 0===e.delayIfDetached&&(e.delayIfDetached=!0),null!==this.readOnly&&(e.readOnly=this.readOnly);var n=e.on.instanceReady;return e.on.instanceReady=function(e){t.instance=e.editor,t.$nextTick().then((function(){t.prepareComponentData(),n&&n(e)}))},e},prepareComponentData:function(){var t=this,e=this.value;this.instance.fire("lockSnapshot"),this.instance.setData(e,{callback:function(){t.$_setUpEditorEvents();var n=t.instance.getData();e!==n?(t.$once("input",(function(){t.$emit("ready",t.instance)})),t.$emit("input",n)):t.$emit("ready",t.instance),t.instance.fire("unlockSnapshot")}})},$_setUpEditorEvents:function(){var t=this,e=this.instance,n=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(){clearTimeout(n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];n=setTimeout(t.bind.apply(t,[r].concat(s)),e)}}((function(n){var r=e.getData();t.value!==r&&t.$emit("input",r,n,e)}),this.throttle);e.on("change",n),e.on("focus",(function(n){t.$emit("focus",n,e)})),e.on("blur",(function(n){t.$emit("blur",n,e)}))}}},u={install:function(t){t.component("ckeditor",a)},component:a};e.default=u}]).default}))}}]);
//# sourceMappingURL=EntityDrupal.umd.min.136.js.map